<<<<<<< HEAD
<section class="main-content">
    <ul class="breadcrumb breadcrumb-style ">
        <li class="breadcrumb-item">
            <h5 class="page-title m-b-0">Profile</h5>
        </li>
        <li class="breadcrumb-item bcrumb-1">
            <a routerLink="/dashboard/main">
                <i class="fas fa-home font-17"></i></a>
        </li>
        <li class="breadcrumb-item">User</li>
        <li class="breadcrumb-item">My Profile</li>
    </ul>
    <div class="section-body" *ngIf="user">
        <div class="row mt-sm-4">
            <div class="col-12 col-md-12 col-lg-4">
                <div class="card author-box">
                    <div class="card-body">
                        <div class="author-box-center">
                            <img alt="image" src="{{picsUrl+user.image}}"
                                class="rounded-circle author-box-picture">
                            <div class="clearfix"></div>
                            <div class="author-box-name">
                                <a href="#" onClick="return false;">{{user.firstName+" "+user.lastName}}</a>
                            </div>
                            <div class="author-box-job">{{user.title}}</div>
                        </div>
                        <div class="text-center">
                            <div class="author-box-description">
                                <p>
                                    {{user.bio}}
                                </p>
                            </div>
                            <div class="mb-2 mt-3">
                                <div class="text-small fw-bold">Follow {{user.firstName}} On</div>
                            </div>
                            <a href="{{user.linkedin}}" target="_blank" class="btn btn-social-icon msr-1 btn-facebook">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="{{user.github}}" target="_blank" class="btn btn-social-icon msr-1 btn-github">
                                <i class="fab fa-github"></i>
                            </a>
                            <div class="w-100 d-sm-none"></div>
                        </div>
                    </div>
                </div>
                <div class="card" *ngIf="active==2">
                    <div class="card-header">
                        <h4>Personal Details</h4>
                    </div>
                    <div class="card-body">
                        <div class="py-4">
                            <p class="clearfix">
                                <span class="float-start">
                                    Birthday
                                </span>
                                <span class="float-end text-muted">
                                    {{user.birthDate| date:"dd/MM/YYYY"}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Phone
                                </span>
                                <span class="float-end text-muted">
                                    {{user.phone}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Mail
                                </span>
                                <span class="float-end text-muted">
                                    {{user.email}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Departement
                                </span>
                                <span class="float-end text-muted">
                                    {{user.departement}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Driving license
                                </span>
                                <span class="float-end text-muted">
                                    {{lisence}}
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
                <div *ngIf="active==1" class="card">
                        <div class="row p-10">
                            <div class="col-lg-10 col-md-10 col-sm-10 col-10" >
                                <h5>Education</h5>
                            </div>
                            <div class="col-lg-2 col-md-2 col-sm-2 col-2 text-end">
                                <button (click)="openEducationModal()" class="form-control plus"><i
                                        class="fas fa-plus"></i></button>
                            </div>
                        </div>  
                    <div class="card-body">
                        <div class="row eduSection" *ngFor="let edu of educations" 
                            (mouseenter)="isEduVisible = true" (mouseleave)="isEduVisible = false">
                            <div  class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                <span *ngIf="!edu.present" style="color: rgb(133, 133, 134);">
                                    <small>{{edu.year_start| date:"MM/YYYY"}} to {{edu.year_end|date:"MM/YYYY"}}</small>
                                </span>
                                <span *ngIf="edu.present" style="color: rgb(133, 133, 134);">
                                    <small>{{edu.year_start| date:"MM/YYYY"}} to Present</small>
                                </span>
                            </div>
                            <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-7">
                                <div>
                                    <span><strong>{{edu.diploma}} - {{edu.section}}</strong></span>
                                    <br />
                                    <span>{{edu.establishment}}</span>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2" *ngIf="isEduVisible">
                                <button type="button" class="btn btn-outline-primary"
                                    (click)="openEditEducationModal(edu)" style="border: none;" ngbPopover="Edit item"
                                    triggers="mouseenter:mouseleave" placement="top">
                                    <i class="fas fa-pen"></i>
                                </button>
                                <button type="button" class="btn btn-outline-danger" (click)="deleteEdu(edu._id)"
                                    style="border: none;" ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                    placement="top">
                                    <i class="far fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="active==1" class="card">
                    <div class="row p-10">
                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                            <h5>Languages</h5>
                        </div>
                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                            <button (click)="openLanguageModal()" class="form-control plus"><i
                                    class="fas fa-plus"></i></button>
                        </div>
                    </div>
                    <div class="card-body" (mouseenter)="isLanguageVisible = true" (mouseleave)="isLanguageVisible = false">
                        <ul class="list-unstyled user-progress list-unstyled-border list-unstyled-noborder"
                            *ngFor="let language of languages">
                            <li class="media">
                                <div class="media-body">
                                    <div class="media-title row">
                                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                                            {{language.name}}
                                            <div class="media-progressbar p-t-10">
                                                <ngb-progressbar type="primary" [value]="language.level" height=".4rem"></ngb-progressbar>
                                            </div>
                                        </div>
                                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                                            <span *ngIf="isLanguageVisible">
                                                <button type="button" class="btn btn-outline-primary"
                                                    (click)="openEditLanguageModal(language)" style="border: none;"
                                                    ngbPopover="Edit item" triggers="mouseenter:mouseleave" placement="top">
                                                    <i class="fas fa-pen"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-danger"
                                                    (click)="deleteLanguage(language._id)" style="border: none;"
                                                    ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                    placement="top">
                                                    <i class="far fa-trash-alt"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div *ngIf="active==1" class="card">
                    <div class="row p-10">
                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                            <h5>Skills</h5>
                        </div>
                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                            <button (click)="openSkillsModal()" class="form-control plus"><i
                                    class="fas fa-plus"></i></button>
                        </div>
                    </div>
                    <div class="card-body" (mouseenter)="isSkillVisible = true" (mouseleave)="isSkillVisible = false">
                        <ul class="list-unstyled user-progress list-unstyled-border list-unstyled-noborder"
                            *ngFor="let skill of skills">
                            <li class="media">
                                <div class="media-body">
                                    <div class="media-title row">
                                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                                            {{skill.name}}
                                            <div class="media-progressbar p-t-10">
                                                <ngb-progressbar type="primary" [value]="skill.level" height=".4rem"></ngb-progressbar>
                                            </div>
                                        </div>
                                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                                            <span *ngIf="isSkillVisible">
                                                <button type="button" class="btn btn-outline-primary" (click)="openEditSkillsModal(skill)"
                                                    style="border: none;" ngbPopover="Edit item" triggers="mouseenter:mouseleave" placement="top">
                                                    <i class="fas fa-pen"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-danger" (click)="deleteSkill(skill._id)"
                                                    style="border: none;" ngbPopover="Delete item" triggers="mouseenter:mouseleave" placement="top">
                                                    <i class="far fa-trash-alt"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="col-12 col-md-12 col-lg-8">
                <div class="card">
                    <div class="padding-20">
                        <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
                            <li [ngbNavItem]="1">
                                <a ngbNavLink>CV</a>
                                <ng-template ngbNavContent>
                                    <div class="tab-pane">
                                        <div class="row sections">
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Full Name</strong>
                                                <br>
                                                <p class="text-muted">{{user.firstName+" "+user.lastName}}</p>
                                            </div>
                                            <div class="col-md-2 col-6 b-r">
                                                <strong>Mobile</strong>
                                                <br>
                                                <p class="text-muted">{{user.phone}}</p>
                                            </div>
                                            <div class="col-md-5 col-6 b-r">
                                                <strong>Email</strong>
                                                <br>
                                                <p class="text-muted">{{user.email}}</p>
                                            </div>
                                            <div class="col-md-2 col-6">
                                                <strong>Location</strong>
                                                <br>
                                                <p class="text-muted">{{user.address}}</p>
                                            </div>
                                        </div>
                                        <div class="row sections" >
                                            <div class="col-xl-10 col-lg-10 col-md-10 col-10">
                                                <h6>Summary</h6>
                                            </div>
                                            <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                <button (click)="openEditSummaryModal(user)"
                                                    class="form-control summ"><i
                                                        class="fas fa-pen summIcon"></i></button>
                                            </div>
                                            <p class="pTask" *ngIf="summary">
                                                {{summary.summary}}
                                            </p>
                                        </div>
                                        <div class="row sections">
                                            <div class="row">
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-10 Section">
                                                    <h4>Experience</h4>
                                                </div>
                                                <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                    <button (click)="openExpModal()" class="form-control plus"><i
                                                            class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                            <div class="row p-t-20" *ngFor="let exp of experiences" (mouseenter)="isExpVisible = true" (mouseleave)="isExpVisible = false">
                                                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                                    <span>
                                                        <small *ngIf="!exp.present" style="color: rgb(133, 133, 134);">{{exp.start| date:"MM/YYYY"}} - {{exp.end|date:"MM/YYYY"}}</small>
                                                    </span>
                                                    <span>
                                                        <small *ngIf="exp.present" style="color: rgb(133, 133, 134);">{{exp.start| date:"MM/YYYY"}} - Present</small>
                                                    </span>
                                                </div>
                                                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-8 mainSection">
                                                    <div>
                                                        <h6>{{exp.job}} </h6>
                                                        <span>{{exp.company}}</span>
                                                        <p class="pTask">{{exp.task_description}}</p>
                                                    </div>
                                                </div>
                                                <div class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-1 actionSection" *ngIf="isExpVisible">
                                                    <button type="button" class="btn btn-outline-primary"
                                                        (click)="openEditExpModal(exp)" style="border: none;"
                                                        ngbPopover="Edit item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="fas fa-pen"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger"
                                                        (click)="deleteExp(exp._id)" style="border: none;"
                                                        ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="far fa-trash-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row sections">
                                            <div class="row">
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-10">
                                                    <h4>Certification</h4>
                                                </div>
                                                <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                    <button (click)="openCertifModal()" class="form-control plus"><i
                                                            class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                            <div class="row p-t-20" *ngFor="let cert of certifications"
                                                (mouseenter)="isCertVisible = true"
                                                (mouseleave)="isCertVisible = false">
                                                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                                    <span style="color: rgb(133, 133, 134);">
                                                        <small>{{cert.date| date:"MM/YYYY"}} </small>
                                                    </span>
                                                </div>
                                                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-8 mainSection" >
                                                    
                                                        <h6 class="certiLink"  (click)="openCertiFile(cert)">{{cert.domaine}}</h6>
                                                        <!-- <h6 class="certiLink" *ngIf="cert.cert_file.length!==0" (click)="openCertiFile(cert)">{{cert.domaine}}</h6>
                                                        <h6 class="certiLink" *ngIf="cert.cert_file===undefined || cert.cert_file.length===0" (click)="openCertiFileNotFound()">{{cert.domaine}}</h6> -->
                                                        <span class="pTask">Credential ID: {{cert.credential}}</span>
                                                    
                                                </div>
                                                <div class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-1 actionSection" *ngIf="isCertVisible">
                                                    <button type="button" class="btn btn-outline-primary"
                                                        (click)="openEditCertifModal(cert)" style="border: none;"
                                                        ngbPopover="Edit item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="fas fa-pen"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger"
                                                        (click)="deleteCert(cert._id)" style="border: none;"
                                                        ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="far fa-trash-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row sections">
                                            <div class="row">
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-10">
                                                    <h4>Projects</h4>
                                                </div>
                                                <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                    <button (click)="openProjectModal()" class="form-control plus"><i
                                                            class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                            <div class="row p-t-20" *ngFor="let proj of projets"
                                                (mouseenter)="isProjVisible = true"
                                                (mouseleave)="isProjVisible = false">
                                                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                                    <span>
                                                        <small style="color: rgb(133, 133, 134);">{{proj.date| date:"MM/YYYY"}} </small></span>
                                                </div>
                                                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-8 mainSection">
                                                    
                                                        <h6>{{proj.title}} </h6>
                                                        <span>{{proj.organization}}</span>
                                                        <p class="pTask">{{proj.description}}</p>
                                                    
                                                </div>
                                                <div class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-1 actionSection" *ngIf="isProjVisible">
                                                    <button type="button" class="btn btn-outline-primary"
                                                        (click)="openEditProjectModal(proj)" style="border: none;"
                                                        ngbPopover="Edit item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="fas fa-pen"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger"
                                                        (click)="deleteProj(proj._id)" style="border: none;"
                                                        ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="far fa-trash-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <button class="btn btn-outline-primary" (click)="downloadResume(projets,certifications,experiences,educations,skills,user.cv)"
                                                type="button">Download <i class="fas fa-eye"></i></button>
                                        </div>
                                    </div>
                                </ng-template>
                            </li>
                            <li [ngbNavItem]="2">
                                <a ngbNavLink>Setting</a>
                                <ng-template ngbNavContent>
                                    <div *ngIf="loading==true" class="d-flex justify-content-center align-items-center loading">
                                        <div class="spinner-border">
                                          <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                    <form name="personalData" [formGroup]="personalData" (ngSubmit)="onSubmit(personalData)">
                                        <div class="card-header">
                                            <h4>Edit Profile</h4>
                                        </div>
                                        <div class="card-body" *ngIf="user">
                                            <div class="row">
                                                <div class="form-group col-md-6 col-12">
                                                    <label>First Name</label>
                                                    <input type="text" class="form-control" formControlName="firstName">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('fname')?.valid && personalData.get('fname')?.touched"> first name is required
                                                    </small> -->
                                                </div>
                                                <div class="form-group col-md-6 col-12">
                                                    <label>Last Name</label>
                                                    <input type="text" class="form-control" formControlName="lastName">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('lname')?.valid && personalData.get('lname')?.touched"> Last name is required
                                                    </small> -->
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-md-7 col-12">
                                                    <label>Address</label>
                                                    <input type="text" class="form-control" formControlName="address">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('address')?.valid && personalData.get('address')?.touched"> Address is required
                                                    </small> -->
                                                </div>
                                                <div class="form-group col-md-5 col-12">
                                                    <label>Phone</label>
                                                    <input type="tel" class="form-control" formControlName="phone">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('phone')?.valid && personalData.get('phone')?.touched"> Phone is required
                                                    </small> -->
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group position-relative">
                                                        <label>Family situation <span
                                                                class="text-danger"></span></label>
                                                        <select formControlName="FS" class="form-select">
                                                            <option selected disabled>Choose...</option>
                                                            <option *ngFor="let s of fs" [ngValue]="s">{{s}}</option>
                                                        </select>
                                                        <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('fs')?.valid && personalData.get('fs')?.touched"> Family situation is
                                                        invalid
                                                      </small> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Bio</label>
                                                    <textarea class="form-control" placeholder="Write your bio here..."
                                                        formControlName="bio"></textarea> <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('address')?.valid && personalData.get('address')?.touched"> Address is required
                                                    </small> -->
                                                </div>
                                            </div>
                                            <br>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">
                                                                <i class="fab fa-github"></i>
                                                            </span>
                                                        </div>
                                                        <input type="text" formControlName="github" class="form-control" placeholder="github.com/username">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">
                                                                <i class="fab fa-linkedin-in"></i>
                                                            </span>
                                                        </div>
                                                        <input type="text" formControlName="linkedin" class="form-control" placeholder="liknedin.com/in/username">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Profile picture<span class="text-danger"></span></label>
                                                    <ngx-dropzone style="background-color: transparent;" [multiple]="false" (change)="onSelect($event)" >
                                                        <ngx-dropzone-label>You can click or drag & drop
                                                            here!</ngx-dropzone-label>
                                                        <ngx-dropzone-image-preview style="width: 250px;" [removable]="true" (removed)="onRemove(f)" *ngFor="let f of files" [file]="f" >
                                                            <!-- <ngx-dropzone-label><div style="color: rgb(151, 82, 82);width: 150px;height: 150px;"></div></ngx-dropzone-label> -->
                                                        </ngx-dropzone-image-preview>
                                                    </ngx-dropzone>
                                                    <!-- <input type="file" class="form-control" #image formControlName="image" multiple="false"/> -->
                                                </div>
                                            </div>

                                        </div>
                                        <div class="card-footer text-end">
                                            <button type="submit" class="btn btn-primary">Save Changes</button>
                                        </div>
                                    </form>
                                </ng-template>
                            </li>
                            <li [ngbNavItem]="3">
                                <a ngbNavLink>Security</a>
                                <ng-template ngbNavContent>
                                    <form class="register-form" [formGroup]="securityForm"
                                        (ngSubmit)="onValidate(securityForm)">
                                        <div class="card-header">
                                            <h4>Change password</h4>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="form-group col-12">
                                                    <label>Password</label>
                                                    <input type="password" class="form-control"
                                                        formControlName="password">
                                                    <small class="form-text text-danger"
                                                        *ngIf="!securityForm.get('password')?.valid && securityForm.get('password')?.touched">
                                                        Password is required
                                                    </small>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-12">
                                                    <label>Confirm password</label>
                                                    <input type="password" class="form-control"
                                                        formControlName="cpassword">
                                                    <small class="form-text text-danger"
                                                        *ngIf="!securityForm.get('cpassword')?.valid && securityForm.get('cpassword')?.touched">
                                                        Password is required
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-footer text-end">
                                            <button type="submit" class="btn btn-primary"
                                                [disabled]="!securityForm.valid">Save Changes</button>
                                        </div>
                                    </form>
                                </ng-template>
                            </li>
                        </ul>
                        <div [ngbNavOutlet]="nav" class="mt-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

=======
<section class="main-content">
    <ul class="breadcrumb breadcrumb-style ">
        <li class="breadcrumb-item">
            <h5 class="page-title m-b-0">Profile</h5>
        </li>
        <li class="breadcrumb-item bcrumb-1">
            <a routerLink="/dashboard/main">
                <i class="fas fa-home font-17"></i></a>
        </li>
        <li class="breadcrumb-item">User</li>
        <li class="breadcrumb-item">My Profile</li>
    </ul>
    <div class="section-body" *ngIf="user">
        <div class="row mt-sm-4">
            <div class="col-12 col-md-12 col-lg-4">
                <div class="card author-box">
                    <div class="card-body">
                        <div class="author-box-center">
                            <img alt="image" src="{{picsUrl+user.image}}"
                                class="rounded-circle author-box-picture">
                            <div class="clearfix"></div>
                            <div class="author-box-name">
                                <a href="#" onClick="return false;">{{user.firstName+" "+user.lastName}}</a>
                            </div>
                            <div class="author-box-job">{{user.title}}</div>
                        </div>
                        <div class="text-center">
                            <div class="author-box-description">
                                <p>
                                    {{user.bio}}
                                </p>
                            </div>
                            <div class="mb-2 mt-3">
                                <div class="text-small fw-bold">Follow {{user.firstName}} On</div>
                            </div>
                            <a href="{{user.linkedin}}" target="_blank" class="btn btn-social-icon msr-1 btn-facebook">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="{{user.github}}" target="_blank" class="btn btn-social-icon msr-1 btn-github">
                                <i class="fab fa-github"></i>
                            </a>
                            <div class="w-100 d-sm-none"></div>
                        </div>
                    </div>
                </div>
                <div class="card" *ngIf="active==2">
                    <div class="card-header">
                        <h4>Personal Details</h4>
                    </div>
                    <div class="card-body">
                        <div class="py-4">
                            <p class="clearfix">
                                <span class="float-start">
                                    Birthday
                                </span>
                                <span class="float-end text-muted">
                                    {{user.birthDate| date:"dd/MM/YYYY"}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Phone
                                </span>
                                <span class="float-end text-muted">
                                    {{user.phone}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Mail
                                </span>
                                <span class="float-end text-muted">
                                    {{user.email}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Departement
                                </span>
                                <span class="float-end text-muted">
                                    {{user.departement}}
                                </span>
                            </p>
                            <p class="clearfix">
                                <span class="float-start">
                                    Driving license
                                </span>
                                <span class="float-end text-muted">
                                    {{lisence}}
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
                <div *ngIf="active==1" class="card">
                        <div class="row p-10">
                            <div class="col-lg-10 col-md-10 col-sm-10 col-10" >
                                <h5>Education</h5>
                            </div>
                            <div class="col-lg-2 col-md-2 col-sm-2 col-2 text-end">
                                <button (click)="openEducationModal()" class="form-control plus"><i
                                        class="fas fa-plus"></i></button>
                            </div>
                        </div>  
                    <div class="card-body">
                        <div class="row eduSection" *ngFor="let edu of educations" 
                            (mouseenter)="isEduVisible = true" (mouseleave)="isEduVisible = false">
                            <div  class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                <span *ngIf="!edu.present" style="color: rgb(133, 133, 134);">
                                    <small>{{edu.year_start| date:"MM/YYYY"}} to {{edu.year_end|date:"MM/YYYY"}}</small>
                                </span>
                                <span *ngIf="edu.present" style="color: rgb(133, 133, 134);">
                                    <small>{{edu.year_start| date:"MM/YYYY"}} to Present</small>
                                </span>
                            </div>
                            <div class="col-xl-7 col-lg-7 col-md-7 col-sm-7 col-7">
                                <div>
                                    <span><strong>{{edu.diploma}} - {{edu.section}}</strong></span>
                                    <br />
                                    <span>{{edu.establishment}}</span>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2" *ngIf="isEduVisible">
                                <button type="button" class="btn btn-outline-primary"
                                    (click)="openEditEducationModal(edu)" style="border: none;" ngbPopover="Edit item"
                                    triggers="mouseenter:mouseleave" placement="top">
                                    <i class="fas fa-pen"></i>
                                </button>
                                <button type="button" class="btn btn-outline-danger" (click)="deleteEdu(edu._id)"
                                    style="border: none;" ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                    placement="top">
                                    <i class="far fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="active==1" class="card">
                    <div class="row p-10">
                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                            <h5>Languages</h5>
                        </div>
                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                            <button (click)="openLanguageModal()" class="form-control plus"><i
                                    class="fas fa-plus"></i></button>
                        </div>
                    </div>
                    <div class="card-body" (mouseenter)="isLanguageVisible = true" (mouseleave)="isLanguageVisible = false">
                        <ul class="list-unstyled user-progress list-unstyled-border list-unstyled-noborder"
                            *ngFor="let language of languages">
                            <li class="media">
                                <div class="media-body">
                                    <div class="media-title row">
                                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                                            {{language.name}}
                                            <div class="media-progressbar p-t-10">
                                                <ngb-progressbar type="primary" [value]="language.level" height=".4rem"></ngb-progressbar>
                                            </div>
                                        </div>
                                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                                            <span *ngIf="isLanguageVisible">
                                                <button type="button" class="btn btn-outline-primary"
                                                    (click)="openEditLanguageModal(language)" style="border: none;"
                                                    ngbPopover="Edit item" triggers="mouseenter:mouseleave" placement="top">
                                                    <i class="fas fa-pen"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-danger"
                                                    (click)="deleteLanguage(language._id)" style="border: none;"
                                                    ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                    placement="top">
                                                    <i class="far fa-trash-alt"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div *ngIf="active==1" class="card">
                    <div class="row p-10">
                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                            <h5>Skills</h5>
                        </div>
                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                            <button (click)="openSkillsModal()" class="form-control plus"><i
                                    class="fas fa-plus"></i></button>
                        </div>
                    </div>
                    <div class="card-body" (mouseenter)="isSkillVisible = true" (mouseleave)="isSkillVisible = false">
                        <ul class="list-unstyled user-progress list-unstyled-border list-unstyled-noborder"
                            *ngFor="let skill of skills">
                            <li class="media">
                                <div class="media-body">
                                    <div class="media-title row">
                                        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10 col-10">
                                            {{skill.name}}
                                            <div class="media-progressbar p-t-10">
                                                <ngb-progressbar type="primary" [value]="skill.level" height=".4rem"></ngb-progressbar>
                                            </div>
                                        </div>
                                        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-2">
                                            <span *ngIf="isSkillVisible">
                                                <button type="button" class="btn btn-outline-primary" (click)="openEditSkillsModal(skill)"
                                                    style="border: none;" ngbPopover="Edit item" triggers="mouseenter:mouseleave" placement="top">
                                                    <i class="fas fa-pen"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-danger" (click)="deleteSkill(skill._id)"
                                                    style="border: none;" ngbPopover="Delete item" triggers="mouseenter:mouseleave" placement="top">
                                                    <i class="far fa-trash-alt"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="col-12 col-md-12 col-lg-8">
                <div class="card">
                    <div class="padding-20">
                        <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
                            <li [ngbNavItem]="1">
                                <a ngbNavLink>CV</a>
                                <ng-template ngbNavContent>
                                    <div class="tab-pane">
                                        <div class="row sections">
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Full Name</strong>
                                                <br>
                                                <p class="text-muted">{{user.firstName+" "+user.lastName}}</p>
                                            </div>
                                            <div class="col-md-2 col-6 b-r">
                                                <strong>Mobile</strong>
                                                <br>
                                                <p class="text-muted">{{user.phone}}</p>
                                            </div>
                                            <div class="col-md-5 col-6 b-r">
                                                <strong>Email</strong>
                                                <br>
                                                <p class="text-muted">{{user.email}}</p>
                                            </div>
                                            <div class="col-md-2 col-6">
                                                <strong>Location</strong>
                                                <br>
                                                <p class="text-muted">{{user.address}}</p>
                                            </div>
                                        </div>
                                        <div class="row sections" >
                                            <div class="col-xl-10 col-lg-10 col-md-10 col-10">
                                                <h6>Summary</h6>
                                            </div>
                                            <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                <button (click)="openEditSummaryModal(user)"
                                                    class="form-control summ"><i
                                                        class="fas fa-pen summIcon"></i></button>
                                            </div>
                                            <p class="pTask" *ngIf="summary">
                                                {{summary.summary}}
                                            </p>
                                        </div>
                                        <div class="row sections">
                                            <div class="row">
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-10 Section">
                                                    <h4>Experience</h4>
                                                </div>
                                                <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                    <button (click)="openExpModal()" class="form-control plus"><i
                                                            class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                            <div class="row p-t-20" *ngFor="let exp of experiences" (mouseenter)="isExpVisible = true" (mouseleave)="isExpVisible = false">
                                                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                                    <span>
                                                        <small *ngIf="!exp.present" style="color: rgb(133, 133, 134);">{{exp.start| date:"MM/YYYY"}} - {{exp.end|date:"MM/YYYY"}}</small>
                                                    </span>
                                                    <span>
                                                        <small *ngIf="exp.present" style="color: rgb(133, 133, 134);">{{exp.start| date:"MM/YYYY"}} - Present</small>
                                                    </span>
                                                </div>
                                                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-8 mainSection">
                                                    <div>
                                                        <h6>{{exp.job}} </h6>
                                                        <span>{{exp.company}}</span>
                                                        <p class="pTask">{{exp.task_description}}</p>
                                                    </div>
                                                </div>
                                                <div class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-1 actionSection" *ngIf="isExpVisible">
                                                    <button type="button" class="btn btn-outline-primary"
                                                        (click)="openEditExpModal(exp)" style="border: none;"
                                                        ngbPopover="Edit item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="fas fa-pen"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger"
                                                        (click)="deleteExp(exp._id)" style="border: none;"
                                                        ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="far fa-trash-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row sections">
                                            <div class="row">
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-10">
                                                    <h4>Certification</h4>
                                                </div>
                                                <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                    <button (click)="openCertifModal()" class="form-control plus"><i
                                                            class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                            <div class="row p-t-20" *ngFor="let cert of certifications"
                                                (mouseenter)="isCertVisible = true"
                                                (mouseleave)="isCertVisible = false">
                                                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                                    <span style="color: rgb(133, 133, 134);">
                                                        <small>{{cert.date| date:"MM/YYYY"}} </small>
                                                    </span>
                                                </div>
                                                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-8 mainSection" >
                                                    
                                                        <h6 class="certiLink"  (click)="openCertiFile(cert)">{{cert.domaine}}</h6>
                                                        <!-- <h6 class="certiLink" *ngIf="cert.cert_file.length!==0" (click)="openCertiFile(cert)">{{cert.domaine}}</h6>
                                                        <h6 class="certiLink" *ngIf="cert.cert_file===undefined || cert.cert_file.length===0" (click)="openCertiFileNotFound()">{{cert.domaine}}</h6> -->
                                                        <span class="pTask">Credential ID: {{cert.credential}}</span>
                                                    
                                                </div>
                                                <div class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-1 actionSection" *ngIf="isCertVisible">
                                                    <button type="button" class="btn btn-outline-primary"
                                                        (click)="openEditCertifModal(cert)" style="border: none;"
                                                        ngbPopover="Edit item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="fas fa-pen"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger"
                                                        (click)="deleteCert(cert._id)" style="border: none;"
                                                        ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="far fa-trash-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row sections">
                                            <div class="row">
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-10">
                                                    <h4>Projects</h4>
                                                </div>
                                                <div class="col-xl-2 col-lg-2 col-md-2 col-2">
                                                    <button (click)="openProjectModal()" class="form-control plus"><i
                                                            class="fas fa-plus"></i></button>
                                                </div>
                                            </div>
                                            <div class="row p-t-20" *ngFor="let proj of projets"
                                                (mouseenter)="isProjVisible = true"
                                                (mouseleave)="isProjVisible = false">
                                                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-3">
                                                    <span>
                                                        <small style="color: rgb(133, 133, 134);">{{proj.date| date:"MM/YYYY"}} </small></span>
                                                </div>
                                                <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-8 mainSection">
                                                    
                                                        <h6>{{proj.title}} </h6>
                                                        <span>{{proj.organization}}</span>
                                                        <p class="pTask">{{proj.description}}</p>
                                                    
                                                </div>
                                                <div class="col-xl-1 col-lg-1 col-md-1 col-sm-1 col-1 actionSection" *ngIf="isProjVisible">
                                                    <button type="button" class="btn btn-outline-primary"
                                                        (click)="openEditProjectModal(proj)" style="border: none;"
                                                        ngbPopover="Edit item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="fas fa-pen"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger"
                                                        (click)="deleteProj(proj._id)" style="border: none;"
                                                        ngbPopover="Delete item" triggers="mouseenter:mouseleave"
                                                        placement="top">
                                                        <i class="far fa-trash-alt"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <button class="btn btn-outline-primary" (click)="downloadResume(projets,certifications,experiences,educations,skills,user.cv)"
                                                type="button">Download <i class="fas fa-eye"></i></button>
                                        </div>
                                    </div>
                                </ng-template>
                            </li>
                            <li [ngbNavItem]="2">
                                <a ngbNavLink>Setting</a>
                                <ng-template ngbNavContent>
                                    <div *ngIf="loading==true" class="d-flex justify-content-center align-items-center loading">
                                        <div class="spinner-border">
                                          <span class="visually-hidden">Loading...</span>
                                        </div>
                                    </div>
                                    <form name="personalData" [formGroup]="personalData" (ngSubmit)="onSubmit(personalData)">
                                        <div class="card-header">
                                            <h4>Edit Profile</h4>
                                        </div>
                                        <div class="card-body" *ngIf="user">
                                            <div class="row">
                                                <div class="form-group col-md-6 col-12">
                                                    <label>First Name</label>
                                                    <input type="text" class="form-control" formControlName="firstName">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('fname')?.valid && personalData.get('fname')?.touched"> first name is required
                                                    </small> -->
                                                </div>
                                                <div class="form-group col-md-6 col-12">
                                                    <label>Last Name</label>
                                                    <input type="text" class="form-control" formControlName="lastName">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('lname')?.valid && personalData.get('lname')?.touched"> Last name is required
                                                    </small> -->
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-md-7 col-12">
                                                    <label>Address</label>
                                                    <input type="text" class="form-control" formControlName="address">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('address')?.valid && personalData.get('address')?.touched"> Address is required
                                                    </small> -->
                                                </div>
                                                <div class="form-group col-md-5 col-12">
                                                    <label>Phone</label>
                                                    <input type="tel" class="form-control" formControlName="phone">
                                                    <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('phone')?.valid && personalData.get('phone')?.touched"> Phone is required
                                                    </small> -->
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group position-relative">
                                                        <label>Family situation <span
                                                                class="text-danger"></span></label>
                                                        <select formControlName="FS" class="form-select">
                                                            <option selected disabled>Choose...</option>
                                                            <option *ngFor="let s of fs" [ngValue]="s">{{s}}</option>
                                                        </select>
                                                        <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('fs')?.valid && personalData.get('fs')?.touched"> Family situation is
                                                        invalid
                                                      </small> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Bio</label>
                                                    <textarea class="form-control" placeholder="Write your bio here..."
                                                        formControlName="bio"></textarea> <!-- <small class="form-text text-danger"
                                                        *ngIf="!personalData.get('address')?.valid && personalData.get('address')?.touched"> Address is required
                                                    </small> -->
                                                </div>
                                            </div>
                                            <br>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">
                                                                <i class="fab fa-github"></i>
                                                            </span>
                                                        </div>
                                                        <input type="text" formControlName="github" class="form-control" placeholder="github.com/username">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">
                                                                <i class="fab fa-linkedin-in"></i>
                                                            </span>
                                                        </div>
                                                        <input type="text" formControlName="linkedin" class="form-control" placeholder="liknedin.com/in/username">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label>Profile picture<span class="text-danger"></span></label>
                                                    <ngx-dropzone style="background-color: transparent;" [multiple]="false" (change)="onSelect($event)" >
                                                        <ngx-dropzone-label>You can click or drag & drop
                                                            here!</ngx-dropzone-label>
                                                        <ngx-dropzone-image-preview style="width: 250px;" [removable]="true" (removed)="onRemove(f)" *ngFor="let f of files" [file]="f" >
                                                            <!-- <ngx-dropzone-label><div style="color: rgb(151, 82, 82);width: 150px;height: 150px;"></div></ngx-dropzone-label> -->
                                                        </ngx-dropzone-image-preview>
                                                    </ngx-dropzone>
                                                    <!-- <input type="file" class="form-control" #image formControlName="image" multiple="false"/> -->
                                                </div>
                                            </div>

                                        </div>
                                        <div class="card-footer text-end">
                                            <button type="submit" class="btn btn-primary">Save Changes</button>
                                        </div>
                                    </form>
                                </ng-template>
                            </li>
                            <li [ngbNavItem]="3">
                                <a ngbNavLink>Security</a>
                                <ng-template ngbNavContent>
                                    <form class="register-form" [formGroup]="securityForm"
                                        (ngSubmit)="onValidate(securityForm)">
                                        <div class="card-header">
                                            <h4>Change password</h4>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="form-group col-12">
                                                    <label>Password</label>
                                                    <input type="password" class="form-control"
                                                        formControlName="password">
                                                    <small class="form-text text-danger"
                                                        *ngIf="!securityForm.get('password')?.valid && securityForm.get('password')?.touched">
                                                        Password is required
                                                    </small>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-12">
                                                    <label>Confirm password</label>
                                                    <input type="password" class="form-control"
                                                        formControlName="cpassword">
                                                    <small class="form-text text-danger"
                                                        *ngIf="!securityForm.get('cpassword')?.valid && securityForm.get('cpassword')?.touched">
                                                        Password is required
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-footer text-end">
                                            <button type="submit" class="btn btn-primary"
                                                [disabled]="!securityForm.valid">Save Changes</button>
                                        </div>
                                    </form>
                                </ng-template>
                            </li>
                        </ul>
                        <div [ngbNavOutlet]="nav" class="mt-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

>>>>>>> origin/main
</section>